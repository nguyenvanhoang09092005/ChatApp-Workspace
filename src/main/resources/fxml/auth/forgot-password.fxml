<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Hyperlink?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.PasswordField?>
<?import javafx.scene.control.ProgressIndicator?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.Separator?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.text.Font?>

<BorderPane prefHeight="700.0" prefWidth="1000.0" styleClass="root" xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1" fx:controller="org.example.chatappclient.client.controllers.auth.ForgotPasswordController">

    <!-- ==================== LEFT PANEL - Branding ==================== -->
    <left>
        <VBox alignment="CENTER" prefHeight="700.0" prefWidth="450.0" styleClass="left-panel" spacing="30">
            <padding>
                <Insets bottom="40" left="40" right="40" top="40" />
            </padding>

            <!-- Icon Container -->
            <StackPane prefHeight="120.0" prefWidth="120.0" styleClass="icon-container">
                <Label styleClass="brand-icon" text="ðŸ”">
                    <font>
                        <Font size="64.0" />
                    </font>
                </Label>
            </StackPane>

            <!-- Brand Title -->
            <VBox alignment="CENTER" spacing="12">
                <Label styleClass="brand-title" text="ChatApp">
                    <font>
                        <Font name="System Bold" size="52.0" />
                    </font>
                </Label>
                <Label styleClass="brand-subtitle" text="KhÃ´i phá»¥c tÃ i khoáº£n cá»§a báº¡n">
                    <font>
                        <Font size="18.0" />
                    </font>
                </Label>
            </VBox>

            <!-- Feature Points -->
            <VBox spacing="16" styleClass="feature-points" maxWidth="350">
                <HBox spacing="12" alignment="CENTER_LEFT">
                    <Label styleClass="feature-icon" text="âœ“">
                        <font>
                            <Font name="System Bold" size="20.0" />
                        </font>
                    </Label>
                    <Label styleClass="feature-text" text="XÃ¡c thá»±c qua email an toÃ n" wrapText="true">
                        <font>
                            <Font size="14.0" />
                        </font>
                    </Label>
                </HBox>

                <HBox spacing="12" alignment="CENTER_LEFT">
                    <Label styleClass="feature-icon" text="âœ“">
                        <font>
                            <Font name="System Bold" size="20.0" />
                        </font>
                    </Label>
                    <Label styleClass="feature-text" text="MÃ£ xÃ¡c thá»±c cÃ³ hiá»‡u lá»±c 15 phÃºt" wrapText="true">
                        <font>
                            <Font size="14.0" />
                        </font>
                    </Label>
                </HBox>

                <HBox spacing="12" alignment="CENTER_LEFT">
                    <Label styleClass="feature-icon" text="âœ“">
                        <font>
                            <Font name="System Bold" size="20.0" />
                        </font>
                    </Label>
                    <Label styleClass="feature-text" text="Quy trÃ¬nh nhanh chÃ³ng vÃ  Ä‘Æ¡n giáº£n" wrapText="true">
                        <font>
                            <Font size="14.0" />
                        </font>
                    </Label>
                </HBox>
            </VBox>

            <!-- Spacer -->
            <Region VBox.vgrow="ALWAYS" />

            <!-- Footer Info -->
            <Label styleClass="panel-footer" text="Â© 2024 ChatApp. All rights reserved.">
                <font>
                    <Font size="11.0" />
                </font>
            </Label>
        </VBox>
    </left>

    <!-- ==================== RIGHT PANEL - Form (SCROLLABLE) ==================== -->
    <center>
        <ScrollPane fitToWidth="true" hbarPolicy="NEVER" vbarPolicy="AS_NEEDED" styleClass="form-scroll-pane">
            <VBox alignment="TOP_CENTER" spacing="24" styleClass="form-container">
                <padding>
                    <Insets bottom="50" left="60" right="60" top="50" />
                </padding>

                <!-- Form Header -->
                <VBox alignment="CENTER" spacing="12" maxWidth="400">
                    <Label styleClass="form-title" text="QuÃªn máº­t kháº©u?">
                        <font>
                            <Font name="System Bold" size="34.0" />
                        </font>
                    </Label>
                    <Label styleClass="form-subtitle" text="Äá»«ng lo láº¯ng! ChÃºng tÃ´i sáº½ giÃºp báº¡n khÃ´i phá»¥c tÃ i khoáº£n"
                           textAlignment="CENTER" wrapText="true" maxWidth="380">
                        <font>
                            <Font size="14.0" />
                        </font>
                    </Label>
                </VBox>

                <!-- Messages Section -->
                <VBox alignment="CENTER" spacing="8" maxWidth="400">
                    <Label fx:id="errorLabel" styleClass="error-label" wrapText="true" maxWidth="400" visible="false" />
                    <Label fx:id="successLabel" styleClass="success-label" wrapText="true" maxWidth="400" visible="false" />
                    <Label fx:id="infoLabel" styleClass="info-label" wrapText="true" maxWidth="400" visible="false" />
                </VBox>

                <!-- Step 1: Email Section -->
                <VBox spacing="10" maxWidth="400" styleClass="form-section">
                    <Label styleClass="section-title" text="ðŸ“§ BÆ°á»›c 1: Nháº­p email cá»§a báº¡n">
                        <font>
                            <Font name="System Bold" size="14.0" />
                        </font>
                    </Label>

                    <VBox spacing="8">
                        <Label styleClass="field-label" text="Äá»‹a chá»‰ Email">
                            <font>
                                <Font size="13.0" />
                            </font>
                        </Label>
                        <TextField fx:id="emailField"
                                   prefHeight="44.0"
                                   promptText="vidu@email.com"
                                   styleClass="custom-textfield">
                            <font>
                                <Font size="14.0" />
                            </font>
                        </TextField>
                        <Label styleClass="hint-label" text="Nháº­p email báº¡n Ä‘Ã£ sá»­ dá»¥ng khi Ä‘Äƒng kÃ½" />
                    </VBox>

                    <HBox spacing="12" alignment="CENTER">
                        <Button fx:id="sendCodeButton"
                                onAction="#handleSendCode"
                                prefHeight="46.0"
                                maxWidth="Infinity"
                                HBox.hgrow="ALWAYS"
                                styleClass="primary-button"
                                text="ðŸ“¨ Gá»­i mÃ£ xÃ¡c thá»±c">
                            <font>
                                <Font name="System Bold" size="14.0" />
                            </font>
                        </Button>
                    </HBox>

                    <StackPane alignment="CENTER" prefHeight="24.0">
                        <Label fx:id="timerLabel" styleClass="timer-label" visible="false">
                            <font>
                                <Font name="System Bold" size="12.0" />
                            </font>
                        </Label>
                    </StackPane>
                </VBox>

                <!-- Separator with text -->
                <HBox alignment="CENTER" spacing="10" maxWidth="400">
                    <Separator HBox.hgrow="ALWAYS" />
                    <Label styleClass="separator-text" text="SAU ÄÃ“">
                        <font>
                            <Font size="11.0" />
                        </font>
                    </Label>
                    <Separator HBox.hgrow="ALWAYS" />
                </HBox>

                <!-- Step 2: Verification Code Section -->
                <VBox spacing="10" maxWidth="400" styleClass="form-section">
                    <Label styleClass="section-title" text="ðŸ”¢ BÆ°á»›c 2: Nháº­p mÃ£ xÃ¡c thá»±c">
                        <font>
                            <Font name="System Bold" size="14.0" />
                        </font>
                    </Label>

                    <VBox spacing="8">
                        <Label styleClass="field-label" text="MÃ£ xÃ¡c thá»±c (6 chá»¯ sá»‘)">
                            <font>
                                <Font size="13.0" />
                            </font>
                        </Label>
                        <TextField fx:id="codeField"
                                   prefHeight="50.0"
                                   promptText="â— â— â— â— â— â—"
                                   styleClass="custom-textfield, code-field"
                                   alignment="CENTER">
                            <font>
                                <Font name="System Bold" size="20.0" />
                            </font>
                        </TextField>
                        <Label styleClass="hint-label" text="Kiá»ƒm tra email cá»§a báº¡n Ä‘á»ƒ láº¥y mÃ£" />
                    </VBox>
                </VBox>

                <!-- Step 3: New Password Section -->
                <VBox spacing="10" maxWidth="400" styleClass="form-section">
                    <Label styleClass="section-title" text="ðŸ”’ BÆ°á»›c 3: Táº¡o máº­t kháº©u má»›i">
                        <font>
                            <Font name="System Bold" size="14.0" />
                        </font>
                    </Label>

                    <VBox spacing="8">
                        <Label styleClass="field-label" text="Máº­t kháº©u má»›i">
                            <font>
                                <Font size="13.0" />
                            </font>
                        </Label>
                        <PasswordField fx:id="newPasswordField"
                                       prefHeight="44.0"
                                       promptText="Nháº­p máº­t kháº©u má»›i"
                                       styleClass="custom-textfield">
                            <font>
                                <Font size="14.0" />
                            </font>
                        </PasswordField>
                    </VBox>

                    <VBox spacing="8">
                        <Label styleClass="field-label" text="XÃ¡c nháº­n máº­t kháº©u">
                            <font>
                                <Font size="13.0" />
                            </font>
                        </Label>
                        <PasswordField fx:id="confirmPasswordField"
                                       prefHeight="44.0"
                                       promptText="Nháº­p láº¡i máº­t kháº©u má»›i"
                                       styleClass="custom-textfield">
                            <font>
                                <Font size="14.0" />
                            </font>
                        </PasswordField>
                        <Label styleClass="hint-label" text="Tá»‘i thiá»ƒu 8 kÃ½ tá»±, bao gá»“m chá»¯ hoa, chá»¯ thÆ°á»ng vÃ  sá»‘" />
                    </VBox>

                    <Button fx:id="resetPasswordButton"
                            onAction="#handleResetPassword"
                            prefHeight="46.0"
                            maxWidth="Infinity"
                            styleClass="primary-button"
                            text="âœ“ Äáº·t láº¡i máº­t kháº©u">
                        <font>
                            <Font name="System Bold" size="14.0" />
                        </font>
                    </Button>
                </VBox>

                <!-- Loading Indicator -->
                <StackPane alignment="CENTER" prefHeight="40.0">
                    <ProgressIndicator fx:id="loadingIndicator"
                                       prefHeight="35.0"
                                       prefWidth="35.0"
                                       visible="false" />
                </StackPane>

                <!-- Back to Login -->
                <VBox alignment="CENTER" spacing="8" maxWidth="400">
                    <Separator maxWidth="200" />
                    <HBox alignment="CENTER" spacing="6">
                        <Label styleClass="secondary-text" text="ÄÃ£ nhá»› máº­t kháº©u?">
                            <font>
                                <Font size="13.0" />
                            </font>
                        </Label>
                        <Hyperlink fx:id="loginLink"
                                   onAction="#handleBackToLogin"
                                   styleClass="link-bold"
                                   text="ÄÄƒng nháº­p ngay">
                            <font>
                                <Font name="System Bold" size="13.0" />
                            </font>
                        </Hyperlink>
                    </HBox>
                </VBox>

                <!-- Spacer -->
                <Region VBox.vgrow="ALWAYS" minHeight="20" />
            </VBox>
        </ScrollPane>
    </center>

</BorderPane>