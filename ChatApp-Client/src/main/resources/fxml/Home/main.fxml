<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.shape.Circle?>

<BorderPane xmlns="http://javafx.com/javafx"
            xmlns:fx="http://javafx.com/fxml"
            fx:controller="org.example.chatappclient.client.controllers.main.MainController"
            styleClass="root">


    <!-- LEFT SIDEBAR - Navigation -->
    <left>
        <VBox fx:id="leftSidebar" styleClass="left-sidebar" prefWidth="72.0">
            <padding>
                <Insets top="16" bottom="16"/>
            </padding>

            <!-- User Avatar -->
            <VBox alignment="CENTER" spacing="8">
                <StackPane styleClass="avatar-container">
                    <ImageView fx:id="userAvatar" fitHeight="48.0" fitWidth="48.0"
                               preserveRatio="true" styleClass="user-avatar">
                        <clip>
                            <Circle centerX="24" centerY="24" radius="24"/>
                        </clip>
                    </ImageView>
                    <Circle fx:id="onlineIndicator" radius="6" fill="#31A24C"
                            stroke="#242526" strokeWidth="2.5"
                            translateX="16" translateY="16"/>
                </StackPane>
            </VBox>

            <Region VBox.vgrow="ALWAYS" minHeight="20"/>

            <!-- Navigation Icons -->
            <VBox spacing="4" alignment="CENTER">
                <Button fx:id="messagesButton" styleClass="nav-button, active">
                    <graphic>
                        <Label text="ðŸ’¬" styleClass="nav-icon"/>
                    </graphic>
                    <tooltip><Tooltip text="Tin nháº¯n"/></tooltip>
                </Button>

                <Button fx:id="contactsButton" styleClass="nav-button">
                    <graphic>
                        <Label text="ðŸ‘¥" styleClass="nav-icon"/>
                    </graphic>
                    <tooltip><Tooltip text="Danh báº¡"/></tooltip>
                </Button>

                <Button fx:id="groupsButton" styleClass="nav-button">
                    <graphic>
                        <Label text="ðŸ‘¨â€ðŸ‘©â€ðŸ‘§â€ðŸ‘¦" styleClass="nav-icon"/>
                    </graphic>
                    <tooltip><Tooltip text="NhÃ³m"/></tooltip>
                </Button>

                <Button fx:id="notificationsButton" styleClass="nav-button">
                    <graphic>
                        <StackPane>
                            <Label text="ðŸ””" styleClass="nav-icon"/>
                            <Label fx:id="notificationBadge" styleClass="notification-badge"
                                   visible="false" StackPane.alignment="TOP_RIGHT"/>
                        </StackPane>
                    </graphic>
                    <tooltip><Tooltip text="ThÃ´ng bÃ¡o"/></tooltip>
                </Button>
            </VBox>

            <Region VBox.vgrow="ALWAYS"/>

            <!-- Bottom Actions -->
            <VBox spacing="4" alignment="CENTER">
                <Separator styleClass="nav-separator"/>

                <Button fx:id="cloudStorageButton" styleClass="nav-button">
                    <graphic>
                        <Label text="â˜ï¸" styleClass="nav-icon"/>
                    </graphic>
                    <tooltip><Tooltip text="Cloud cá»§a tÃ´i"/></tooltip>
                </Button>

                <Button fx:id="settingsButton" styleClass="nav-button">
                    <graphic>
                        <Label text="âš™ï¸" styleClass="nav-icon"/>
                    </graphic>
                    <tooltip><Tooltip text="CÃ i Ä‘áº·t"/></tooltip>
                </Button>
            </VBox>
        </VBox>
    </left>

    <!-- CENTER -->
    <center>
        <HBox>
            <!-- CONVERSATION LIST PANEL -->
            <VBox fx:id="conversationPanel" styleClass="conversation-panel" prefWidth="340.0" minWidth="280.0">

                <!-- Header vá»›i Search -->
                <VBox styleClass="conversation-header" spacing="12">
                    <padding>
                        <Insets top="16" right="16" bottom="12" left="16"/>
                    </padding>

                    <!-- Title vÃ  Actions -->
                    <HBox alignment="CENTER_LEFT" spacing="12">
                        <Label fx:id="panelTitle" text="Tin nháº¯n" styleClass="panel-title"/>
                        <Region HBox.hgrow="ALWAYS"/>

                        <Button fx:id="newGroupButton" styleClass="header-action-btn">
                            <graphic><Label text="ðŸ‘¥+" styleClass="action-icon"/></graphic>
                            <tooltip><Tooltip text="Táº¡o nhÃ³m"/></tooltip>
                        </Button>

                        <Button fx:id="newChatButton" styleClass="header-action-btn">
                            <graphic><Label text="âœï¸" styleClass="action-icon"/></graphic>
                            <tooltip><Tooltip text="Tin nháº¯n má»›i"/></tooltip>
                        </Button>
                    </HBox>

                    <!-- Search Bar -->
                    <HBox styleClass="search-container" alignment="CENTER_LEFT" spacing="8">
                        <Label text="ðŸ”" styleClass="search-icon"/>
                        <TextField fx:id="searchField" promptText="TÃ¬m kiáº¿m"
                                   styleClass="search-field" HBox.hgrow="ALWAYS"/>
                    </HBox>
                </VBox>

                <!-- Filter Tabs -->
                <HBox fx:id="filterTabs" styleClass="filter-tabs" spacing="8" alignment="CENTER_LEFT">
                    <padding>
                        <Insets top="8" right="16" bottom="8" left="16"/>
                    </padding>
                    <Button fx:id="allTab" text="Táº¥t cáº£" styleClass="filter-tab, active"/>
                    <Button fx:id="unreadTab" text="ChÆ°a Ä‘á»c" styleClass="filter-tab"/>
                    <Button fx:id="groupTab" text="NhÃ³m" styleClass="filter-tab"/>
                </HBox>

                <!-- Conversation List -->
                <ScrollPane fx:id="conversationScrollPane" fitToWidth="true"
                            VBox.vgrow="ALWAYS" styleClass="conversation-scroll">
                    <VBox fx:id="conversationListContainer" styleClass="conversation-list"/>
                </ScrollPane>
            </VBox>

            <!-- CHAT AREA -->
            <VBox fx:id="chatPanel" HBox.hgrow="ALWAYS" visible="false" styleClass="chat-panel">

                <!-- Chat Header -->
                <HBox fx:id="chatHeader" styleClass="chat-header" alignment="CENTER_LEFT" spacing="12">
                    <padding>
                        <Insets top="12" right="20" bottom="12" left="20"/>
                    </padding>

                    <StackPane styleClass="chat-avatar-container">
                        <ImageView fx:id="chatPartnerAvatar" fitHeight="44.0" fitWidth="44.0"
                                   preserveRatio="true">
                            <clip><Circle centerX="22" centerY="22" radius="22"/></clip>
                        </ImageView>
                        <Circle fx:id="partnerOnlineIndicator" radius="5" fill="#31A24C"
                                stroke="white" strokeWidth="2" translateX="15" translateY="15"/>
                    </StackPane>

                    <VBox spacing="2" HBox.hgrow="ALWAYS">
                        <Label fx:id="chatPartnerName" styleClass="chat-partner-name"/>
                        <Label fx:id="chatPartnerStatus" styleClass="chat-partner-status"/>
                    </VBox>

                    <!-- Chat Actions -->
                    <HBox spacing="4" styleClass="chat-actions">
                        <Button fx:id="searchInChatBtn" styleClass="chat-action-btn">
                            <graphic><Label text="ðŸ”" styleClass="chat-action-icon"/></graphic>
                        </Button>
                        <Button fx:id="audioCallButton" styleClass="chat-action-btn">
                            <graphic><Label text="ðŸ“ž" styleClass="chat-action-icon"/></graphic>
                        </Button>
                        <Button fx:id="videoCallButton" styleClass="chat-action-btn">
                            <graphic><Label text="ðŸ“¹" styleClass="chat-action-icon"/></graphic>
                        </Button>
                        <Button fx:id="chatInfoButton" styleClass="chat-action-btn">
                            <graphic><Label text="â„¹ï¸" styleClass="chat-action-icon"/></graphic>
                        </Button>
                    </HBox>
                </HBox>

                <!-- Messages Area -->
                <ScrollPane fx:id="chatScrollPane" fitToWidth="true" VBox.vgrow="ALWAYS"
                            styleClass="messages-scroll">
                    <VBox fx:id="chatMessagesContainer" styleClass="messages-container" spacing="4">
                        <padding>
                            <Insets top="16" right="20" bottom="16" left="20"/>
                        </padding>
                    </VBox>
                </ScrollPane>

                <!-- Typing Indicator -->
                <HBox fx:id="typingIndicator" styleClass="typing-indicator" visible="false"
                      alignment="CENTER_LEFT" spacing="8">
                    <padding>
                        <Insets top="4" right="20" bottom="4" left="20"/>
                    </padding>
                    <HBox styleClass="typing-dots" spacing="3">
                        <Circle radius="4" styleClass="typing-dot"/>
                        <Circle radius="4" styleClass="typing-dot"/>
                        <Circle radius="4" styleClass="typing-dot"/>
                    </HBox>
                    <Label fx:id="typingLabel" styleClass="typing-text"/>
                </HBox>

                <!-- Reply Preview -->
                <HBox fx:id="replyPreview" styleClass="reply-preview" visible="false"
                      alignment="CENTER_LEFT" spacing="10">
                    <padding>
                        <Insets top="10" right="20" bottom="10" left="20"/>
                    </padding>
                    <VBox HBox.hgrow="ALWAYS" spacing="2">
                        <Label fx:id="replyToName" styleClass="reply-to-name"/>
                        <Label fx:id="replyToContent" styleClass="reply-to-content"/>
                    </VBox>
                    <Button fx:id="cancelReplyBtn" styleClass="cancel-reply-btn" text="âœ•"/>
                </HBox>

                <!-- Message Input Area -->
                <HBox styleClass="input-container" alignment="CENTER" spacing="8">
                    <padding>
                        <Insets top="12" right="16" bottom="12" left="16"/>
                    </padding>

                    <!-- Attachment Actions -->
                    <HBox spacing="4" styleClass="input-actions">
                        <Button fx:id="stickerButton" styleClass="input-action-btn">
                            <graphic><Label text="ðŸ˜Š" styleClass="input-action-icon"/></graphic>
                            <tooltip><Tooltip text="Sticker"/></tooltip>
                        </Button>
                        <Button fx:id="imageButton" styleClass="input-action-btn">
                            <graphic><Label text="ðŸ–¼ï¸" styleClass="input-action-icon"/></graphic>
                            <tooltip><Tooltip text="HÃ¬nh áº£nh"/></tooltip>
                        </Button>
                        <Button fx:id="attachButton" styleClass="input-action-btn">
                            <graphic><Label text="ðŸ“Ž" styleClass="input-action-icon"/></graphic>
                            <tooltip><Tooltip text="ÄÃ­nh kÃ¨m file"/></tooltip>
                        </Button>
                    </HBox>

                    <!-- Text Input -->
                    <HBox styleClass="message-input-wrapper" HBox.hgrow="ALWAYS" alignment="CENTER">
                        <TextArea fx:id="messageInputArea" promptText="Nháº­p tin nháº¯n..."
                                  wrapText="true" prefRowCount="1" styleClass="message-input"/>
                    </HBox>

                    <!-- Send Actions -->
                    <HBox spacing="4">
                        <Button fx:id="voiceButton" styleClass="input-action-btn">
                            <graphic><Label text="ðŸŽ¤" styleClass="input-action-icon"/></graphic>
                            <tooltip><Tooltip text="Gá»­i tin nháº¯n thoáº¡i"/></tooltip>
                        </Button>
                        <Button fx:id="likeButton" styleClass="input-action-btn, like-btn">
                            <graphic><Label text="ðŸ‘" styleClass="like-icon"/></graphic>
                        </Button>
                        <Button fx:id="sendButton" styleClass="send-button" visible="false">
                            <graphic><Label text="âž¤" styleClass="send-icon"/></graphic>
                        </Button>
                    </HBox>
                </HBox>
            </VBox>

            <!-- WELCOME SCREEN -->
            <VBox fx:id="welcomeScreen" alignment="CENTER" spacing="20"
                  HBox.hgrow="ALWAYS" styleClass="welcome-screen">

                <VBox alignment="CENTER" spacing="16" styleClass="welcome-content">
                    <Label styleClass="welcome-logo" text="ðŸ’¬"/>
                    <Label text="ChÃ o má»«ng Ä‘áº¿n vá»›i ChatApp" styleClass="welcome-title"/>
                    <Label text="KhÃ¡m phÃ¡ nhá»¯ng tiá»‡n Ã­ch há»— trá»£ lÃ m viá»‡c vÃ  trÃ² chuyá»‡n"
                           styleClass="welcome-subtitle"/>
                    <Label text="cÃ¹ng ngÆ°á»i thÃ¢n, báº¡n bÃ¨" styleClass="welcome-subtitle"/>
                </VBox>

                <VBox alignment="CENTER" spacing="12" styleClass="welcome-features">
                    <HBox spacing="12" alignment="CENTER">
                        <VBox styleClass="feature-card" alignment="CENTER" spacing="8">
                            <Label text="ðŸ’¬" styleClass="feature-icon"/>
                            <Label text="Nháº¯n tin" styleClass="feature-title"/>
                            <Label text="Gá»­i tin nháº¯n nhanh chÃ³ng" styleClass="feature-desc"/>
                        </VBox>
                        <VBox styleClass="feature-card" alignment="CENTER" spacing="8">
                            <Label text="ðŸ“ž" styleClass="feature-icon"/>
                            <Label text="Gá»i Ä‘iá»‡n" styleClass="feature-title"/>
                            <Label text="Gá»i thoáº¡i vÃ  video HD" styleClass="feature-desc"/>
                        </VBox>
                        <VBox styleClass="feature-card" alignment="CENTER" spacing="8">
                            <Label text="ðŸ‘¥" styleClass="feature-icon"/>
                            <Label text="NhÃ³m chat" styleClass="feature-title"/>
                            <Label text="Táº¡o nhÃ³m dá»… dÃ ng" styleClass="feature-desc"/>
                        </VBox>
                    </HBox>
                </VBox>

                <Button fx:id="startChatButton" text="Báº¯t Ä‘áº§u trÃ² chuyá»‡n" styleClass="start-chat-btn"/>
            </VBox>
        </HBox>
    </center>

    <!-- RIGHT SIDEBAR - Chat Info (Optional) -->
    <right>
        <VBox fx:id="infoSidebar"
              styleClass="info-sidebar"
              prefWidth="320"
              visible="false"
              managed="false">
        </VBox>
    </right>

</BorderPane>